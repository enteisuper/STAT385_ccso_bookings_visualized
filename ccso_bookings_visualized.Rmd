---
title: "STAT 385 Final Project"
author: ""
date: "Due by 12:00 PM noon CST on 05/14/2021"
output: html_document
---

Submit a final project proposal and a storyboard. See Chapter 1 of Knaflic's **Storytelling with Data** for ideas on creating a storyboard. The proposal should include the following information:

- the name and roles of all of the group members

- tentative title of the project

- the dataset

- summary of the intentions and goals of the project

- storyboard


```{r}
library(tidyverse)
library(ggplot2)

ccso_bookings <- read.csv("https://uofi.box.com/shared/static/9elozjsg99bgcb7gb546wlfr3r2gc9b7.csv")

data(mtcars)
dat <- mtcars %>% dplyr::select(mpg, cyl, disp) %>% 
  rename(Cylinder = cyl) %>%
  mutate(Cylinder = as.factor(Cylinder)) 
# Define UI for application that draws a histogram
ui <- fluidPage(
  titlePanel("Cars data visualization"),
  
  tags$p("Visualization of car power vs efficiency across cylinder types."),
  
  sidebarPanel(
    
    checkboxGroupInput("checkGroup", 
      h3("Cylinders"), choices = list("4" = 4, 
      "6" = 6, "8" = 8), selected = 6),
    sliderInput("slider_mpg", h3("mpg"),
      min = floor(min(mtcars$mpg)), max = ceiling(max(mtcars$mpg)), 
        value = c(15, 27)),
    sliderInput("slider_disp", h3("disp"),
      min = floor(min(mtcars$disp)), max = ceiling(max(mtcars$disp)), 
        value = c(150, 350)), 
    width = 3
  ),
    
  mainPanel( 
    # Show a plot of the generated distribution
    plotOutput("Plot")
  )
)
# Define server logic required to draw a ggplot
server <- function(input, output) {
    output$Plot <- renderPlot({
        # generate bins based on input$bins from ui.R
        dat <- dat %>% 
          filter(input$slider_mpg[1] < mpg & mpg < input$slider_mpg[2]) %>%
          filter(input$slider_disp[1] < disp & disp < input$slider_disp[2]) %>%
          filter(Cylinder %in% input$checkGroup)
        ggplot(dat, aes(x = mpg, y = disp, 
          group = Cylinder, color = Cylinder)) + 
          geom_point(pch = 19, cex = 3) + 
          theme_minimal() + 
          scale_color_manual(
            values =  c("4"="blue",
                "6"="orange",
                "8"="black")) + 
          labs(x="Miles per gallon (mpg)", y="Displacement (cubic inches)")
  })
}
# Run the app
shinyApp(ui = ui, server = server,options = list(height = 600))
```



#### Continuing on

```{r}
# Define UI for application that draws a histogram
ui <- fluidPage(
    
  tabsetPanel(
    
    tabPanel("SliderInput",
    # Sidebar with a slider input for number of bins 
      sliderInput(inputId = "bins",
                        label = "Number of bins:",
                        min = 1,
                        max = 50,
                        value = 30)
   ),  #the comma is important
   
    tabPanel("HistogramOutput",
    # Show a plot of the generated distribution
      plotOutput("distPlot")
      )
  )
)
# Define server logic required to draw a histogram
server <- function(input, output) {
    output$distPlot <- renderPlot({
        # generate bins based on input$bins from ui.R
        x    <- faithful[, 2]
        bins <- seq(min(x), max(x), length.out = input$bins + 1)
        # draw the histogram with the specified number of bins
        hist(x, breaks = bins, col = 'darkgray', border = 'white')
  })
}
# Run the application 
shinyApp(ui = ui, server = server, options = list(height = 500))
```


```{r}
# Define UI for application that draws a histogram
ui <- fluidPage(
    
  navlistPanel(
    
    tabPanel("SliderInput",
    # Sidebar with a slider input for number of bins 
      sliderInput(inputId = "bins",
                        label = "Number of bins:",
                        min = 1,
                        max = 50,
                        value = 30)
   ),  #the comma is important
   
    tabPanel("HistogramOutput",
    # Show a plot of the generated distribution
      plotOutput("distPlot")
      )
  )
)
# Define server logic required to draw a histogram
server <- function(input, output) {
    output$distPlot <- renderPlot({
        # generate bins based on input$bins from ui.R
        x    <- faithful[, 2]
        bins <- seq(min(x), max(x), length.out = input$bins + 1)
        # draw the histogram with the specified number of bins
        hist(x, breaks = bins, col = 'darkgray', border = 'white')
  })
}
# Run the application 
shinyApp(ui = ui, server = server, options = list(height = 500))
```


```{r}
# Define UI for application that draws a histogram
ui <- #fluidPage( #we replace fluidPage with navbarPage
    
  navbarPage("A Simple App",
    
    tabPanel("Slider Input",
    # Sidebar with a slider input for number of bins 
      sliderInput(inputId = "bins",
                        label = "Number of bins:",
                        min = 1,
                        max = 50,
                        value = 30)
   ),  #the comma is important
   
    tabPanel("Histogram Output",
    # Show a plot of the generated distribution
      plotOutput("distPlot")
      )
)
# Define server logic required to draw a histogram
server <- function(input, output) {
    output$distPlot <- renderPlot({
        # generate bins based on input$bins from ui.R
        x    <- faithful[, 2]
        bins <- seq(min(x), max(x), length.out = input$bins + 1)
        # draw the histogram with the specified number of bins
        hist(x, breaks = bins, col = 'darkgray', border = 'white')
  })
}
# Run the application 
shinyApp(ui = ui, server = server, options = list(height = 500))
```


```{r}
# Define UI for application that draws a histogram
ui <- fluidPage( 
    
  sidebarLayout(
    
    sidebarPanel("Slider Input",
    # Sidebar with a slider input for number of bins 
      sliderInput(inputId = "bins",
                        label = "Number of bins:",
                        min = 1,
                        max = 50,
                        value = 30)
   ),  #the comma is important
   
    mainPanel("HistogramOutput",
    # Show a plot of the generated distribution
      plotOutput("distPlot")
      )
  )
)
# Define server logic required to draw a histogram
server <- function(input, output) {
    output$distPlot <- renderPlot({
        # generate bins based on input$bins from ui.R
        x    <- faithful[, 2]
        bins <- seq(min(x), max(x), length.out = input$bins + 1)
        # draw the histogram with the specified number of bins
        hist(x, breaks = bins, col = 'darkgray', border = 'white')
  })
}
# Run the application 
shinyApp(ui = ui, server = server, options = list(height = 500))
```

abcd