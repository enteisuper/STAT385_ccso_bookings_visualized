---
title: "STAT 385 Final Project"
author: ""
date: "Due by 12:00 PM noon CST on 05/14/2021"
output: html_document
---

YouTube Video: 

```{r}
library(tidyverse)
library(ggplot2)
library(shiny)

ccso_bookings <- read.csv("https://uofi.box.com/shared/static/9elozjsg99bgcb7gb546wlfr3r2gc9b7.csv")

dat <- ccso_bookings %>% dplyr::select(RACE, MARITIAL.STATUS, SEX, CITY, Days.in.Jail) %>%
  rename(Race = RACE) %>%
  mutate(Race = as.factor(Race))  %>%
  rename(MaritalStatus = MARITIAL.STATUS) %>%
  mutate(MaritalStatus = as.factor(MaritalStatus)) %>%
  rename(Sex = SEX) %>%
  mutate(Sex = as.factor(Sex)) %>%
  rename(City = CITY) %>%
  mutate(City = as.factor(City))

dat = dat[dat$Days.in.Jail != "#VALUE!",]
dat$Days.in.Jail = as.numeric(dat$Days.in.Jail)

# Define UI for application that draws a histogram
ui <- fluidPage(
  titlePanel("Length of Time Spent in Champaign County Jails by Various Demographics"),
  
  sidebarPanel(
    
    checkboxGroupInput("checkRace", 
      h3("Race"), choices = list("White" = "White", 
      "Hispanic" = "Hispanic", "White (Hispanic)" = "White (Hispanic)", "Black" = "Black", "Asian/Pacific Islander" = "Asian/Pacific Islander", "Native American" = "Native American", "Unknonwn" = "Unknown")),
    
    checkboxGroupInput("checkMarital", 
      h3("MaritalStatus"), choices = list("Married" =  "Married", "Single" = "Single", "Seperated" = "Separated", "Significant Other", "Divorced" = "Divorced", "Widowed" = "Widowed", "Unknown" = "Unknown")),
    
    checkboxGroupInput("checkSex", 
      h3("Sex"), choices = list("Female" =  "Female", "Male" = "Male")),
    
    checkboxGroupInput("checkCity", 
      h3("City"), choices = list("Champaign" =  "Champaign", "Urbana" = "Urbana")),
    width = 3
  ),
    
  mainPanel( 
    # Show a plot of the generated distribution
    plotOutput("Plot")
  )
)
# Define server logic required to draw a ggplot
server <- function(input, output) {
    output$Plot <- renderPlot({
        # generate bins based on input$bins from ui.R
        dat <- dat %>% 
          filter(Race %in% input$checkRace) %>%
          filter(MaritalStatus %in% input$checkMarital) %>%
          filter(Sex %in% input$checkSex) %>%
          filter(City %in% input$checkCity)
        ggplot(dat, aes(x = dat$Days.in.Jail)) + 
          geom_histogram() + 
          theme_minimal() + 
          labs(x="Length of Time in Jail (Days)")
  })
}
# Run the app
shinyApp(ui = ui, server = server,options = list(height = 600))
```
