---
title: "STAT 385 Final Project"
author: ""
date: "Due by 12:00 PM noon CST on 05/14/2021"
output: html_document
---

YouTube Video: 

```{r}
library(tidyverse)
library(ggplot2)
library(shiny)

original <- read.csv("https://uofi.box.com/shared/static/9elozjsg99bgcb7gb546wlfr3r2gc9b7.csv")

ccso_bookings = original %>% 
    mutate(Booking.Date.Time = parse_datetime(Booking.Date.Time, format = "%m/%d/%y %H:%M:%S")) %>% 
    filter(Release.Date.Time != "1/00/00 00:00:00") %>%
    mutate(Release.Date.Time = parse_datetime(Release.Date.Time, format = "%m/%d/%y %H:%M:%S")) %>% 
    mutate(time.spent.in.jail = as.numeric(difftime(Release.Date.Time, Booking.Date.Time, units = "hours"))) %>%
    select(RACE, SEX, CITY, MARITIAL.STATUS, time.spent.in.jail) %>%
    rename(Race = RACE, Sex = SEX, City = CITY, MaritalStatus = MARITIAL.STATUS, TimeSpentInJail = time.spent.in.jail)

# Define UI for application that draws a histogram
ui <- fluidPage(
    titlePanel("Length of Time Spent in Champaign County Jails by Various Demographics"),
    
    sidebarPanel(
        
        checkboxGroupInput("checkRace", 
        h3("Race"), choices = list("White" = "White", "Hispanic" = "Hispanic", "White (Hispanic)" = "White (Hispanic)", "Black" = "Black", "Asian/Pacific Islander" = "Asian/Pacific Islander", "Native American" = "Native American", "Unknonwn" = "Unknown"), selected = "White"),
        
        checkboxGroupInput("checkMarital", 
        h3("MaritalStatus"), choices = list("Married" =  "Married", "Single" = "Single", "Seperated" = "Separated", "Significant Other", "Divorced" = "Divorced", "Widowed" = "Widowed", "Unknown" = "Unknown"), selected = "Married"),
        
        checkboxGroupInput("checkSex", 
        h3("Sex"), choices = list("Female" =  "Female", "Male" = "Male"), selected = "Female"),
        
        checkboxGroupInput("checkCity", 
        h3("City"), choices = list("Champaign" =  "Champaign", "Urbana" = "Urbana"), selected = "Champaign"),
        width = 3
    ),
    
    mainPanel( 
        # Show a plot of the generated distribution
        plotOutput("Plot")
    )
)
# Define server logic required to draw a ggplot
server <- function(input, output) {
    output$Plot <- renderPlot({
        # generate bins based on input$bins from ui.R
        dat <- ccso_bookings %>% 
            filter(Race %in% input$checkRace) %>%
            filter(MaritalStatus %in% input$checkMarital) %>%
            filter(Sex %in% input$checkSex) %>%
            filter(City %in% input$checkCity)
        
        ggplot(data = dat) +
          geom_histogram(aes(x = D.in.Jail)) +
          theme_minimal()
    })
}
# Run the app
shinyApp(ui = ui, server = server,options = list(height = 600))
```
